# 小红书Agent 浏览器插件

一个智能的小红书评论助手，使用AI帮你生成高质量的评论回复。

## 功能特性

- 🤖 **AI智能生成**: 基于笔记内容和评论上下文，智能生成回复
- 👁️ **视觉理解**: 支持理解笔记中的图片内容（需配置视觉模型）
- 💬 **上下文感知**: 自动追溯父评论，生成更贴合语境的回复
- 🎭 **人设定制**: 支持自定义人设，生成符合个人风格的评论
- 💾 **智能缓存**: 自动缓存笔记理解和生成的评论，节省成本
- 🎨 **原生体验**: UI设计符合小红书风格，无缝融入

## 安装方法

### 1. 下载插件

克隆或下载本项目到本地：

```bash
git clone <repository-url>
cd xhsAgent
```

### 2. 准备图标（可选）

在 `icons` 文件夹中放置插件图标：
- icon16.png (16x16)
- icon48.png (48x48)
- icon128.png (128x128)

如果没有图标，插件也可以正常运行。

### 3. 加载插件到浏览器

#### Chrome / Edge

1. 打开浏览器，进入扩展程序页面
   - Chrome: `chrome://extensions/`
   - Edge: `edge://extensions/`

2. 开启右上角的「开发者模式」

3. 点击「加载已解压的扩展程序」

4. 选择 `xhsAgent` 文件夹

5. 插件安装成功后会自动打开设置页面

## 配置指南

### 1. 评论生成模型配置（必需）

用于生成评论回复的大语言模型：

**推荐配置 - DeepSeek**
- Base URL: `https://api.deepseek.com`
- API Key: 你的 DeepSeek API Key
- 模型名称: `deepseek-chat`

**其他选择**
- OpenAI: `https://api.openai.com/v1`
- OpenRouter: `https://openrouter.ai/api/v1`

### 2. 笔记理解模型配置（可选）

用于理解笔记中的图片和文字内容，需要支持视觉能力的模型。

**推荐配置 - OpenRouter + Qwen VL（免费）**
- Base URL: `https://openrouter.ai/api/v1`
- API Key: 你的 OpenRouter API Key
- 模型名称: `qwen/qwen-vl-max`

**注意**：如果不配置此项，插件将只使用笔记的文字内容（标题+正文）。

### 3. 生成配置

- **每次生成评论数量**: 默认3条，可设置3-10条
- **我的人设**: 可选，用于让AI生成符合你风格的评论

**人设示例**：
```
我是一名AI产品经理，关注AI技术在实际产品中的应用。
我的评论风格是：专业但不失亲和力，喜欢从用户体验的角度分析问题，
会用简单的例子解释复杂的概念。
```

## 使用方法

### 1. 打开小红书笔记

在浏览器中访问小红书网页版，打开任意笔记详情页：

```
https://www.xiaohongshu.com/explore/[笔记ID]
```

### 2. 找到评论区

在笔记下方的评论区，每条评论的点赞、回复按钮后面会出现一个 **AI** 图标。

### 3. 生成回复

1. 点击你想回复的评论旁边的 AI 图标
2. 插件会自动：
   - 理解笔记内容（首次访问时）
   - 分析评论及其父评论
   - 生成多条回复建议
3. 在右侧弹出的面板中选择合适的回复
4. 点击「复制」按钮，粘贴到评论框即可

### 4. 管理生成结果

- **关闭面板**: 点击右上角的 ✕ 按钮
- **重新生成**: 点击「重新生成」按钮
- **查看历史**: 再次点击同一评论的AI图标，会显示上次生成的结果

## 功能说明

### 智能缓存机制

1. **笔记理解缓存**
   - 每个笔记只会理解一次
   - 理解结果保存在本地存储
   - 避免重复调用，节省成本

2. **评论生成缓存**
   - 每条评论的生成结果会被缓存
   - 关闭面板后再次点击，直接显示缓存结果
   - 可以手动「重新生成」来更新

### 上下文理解

插件会自动识别评论的层级关系：
- **一级评论**: 直接基于笔记内容生成回复
- **二级评论**: 会包含父评论的上下文
- 生成的回复更贴合对话场景

### 成本优化建议

1. **笔记理解模型**: 使用免费或低成本的视觉模型（如OpenRouter的qwen-vl）
2. **评论生成模型**: 使用高质量但价格合理的模型（如DeepSeek）
3. **利用缓存**: 避免重复生成同一评论的回复

## 项目结构

```
xhsAgent/
├── manifest.json          # 插件配置文件
├── icons/                 # 图标文件夹
├── js/
│   ├── content.js        # 内容脚本（核心功能）
│   └── background.js     # 后台脚本
├── css/
│   └── content.css       # 样式文件
├── settings/
│   ├── settings.html     # 设置页面
│   ├── settings.js       # 设置逻辑
│   └── settings.css      # 设置样式
└── README.md             # 说明文档
```

## 常见问题

### Q: 点击AI图标没有反应？

A: 请检查：
1. 是否已配置评论生成模型的API Key
2. 打开浏览器控制台（F12），查看是否有错误信息
3. API Key是否有效且有余额

### Q: 生成的评论质量不理想？

A: 可以尝试：
1. 配置更详细的「我的人设」
2. 使用更强大的生成模型
3. 点击「重新生成」多生成几次

### Q: 无法理解笔记中的图片？

A: 请确保：
1. 已配置笔记理解模型（需支持视觉能力）
2. API Key有效且有权限访问视觉模型
3. 如果不需要图片理解，可以不配置此项

### Q: 成本会很高吗？

A: 通过以下方式控制成本：
1. 使用免费或低成本的视觉模型理解笔记
2. 笔记理解结果会被缓存，每个笔记只调用一次
3. 生成的评论也会被缓存，避免重复生成
4. 使用高性价比的模型（如DeepSeek）

## 技术栈

- Manifest V3
- Chrome Extension APIs
- OpenAI-compatible API
- Vanilla JavaScript (无框架依赖)

## 开发说明

如需修改或扩展功能：

1. 核心逻辑在 `js/content.js`
2. UI样式在 `css/content.css`
3. 设置页面在 `settings/` 文件夹
4. 修改后需要在扩展程序页面点击「重新加载」

## 注意事项

1. 本插件仅供学习和个人使用
2. 请遵守小红书社区规范，不要发送垃圾评论
3. API调用产生的费用由用户自行承担
4. 建议设置API调用额度限制，避免意外消费

## License

MIT License

## 更新日志

### v1.0.0 (2025-01-10)

- 首次发布
- 支持AI生成评论回复
- 支持视觉模型理解笔记内容
- 智能缓存机制
- 自定义人设
